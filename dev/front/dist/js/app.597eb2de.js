(function(e){function t(t){for(var o,s,a=t[0],c=t[1],u=t[2],d=0,f=[];d<a.length;d++)s=a[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&f.push(r[s][0]),r[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);l&&l(t);while(f.length)f.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(o=!1)}o&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},r={app:0},i=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"054a":function(e,t,n){},"16e7":function(e,t,n){},"31ae":function(e,t,n){},"3b99":function(e,t,n){},"3f70":function(e,t,n){"use strict";n("bc8f")},4175:function(e,t,n){"use strict";n("31ae")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Home",{class:{mobile:e.isMobile}})],1)},i=[],s=new o["a"]({data:{isMobile:!1}}),a=n("7707"),c=n.n(a),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{hidden:!e.loaded},attrs:{id:"home"}},[n("Userland")],1)},l=[],d=(n("ac1f"),n("1276"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.registered?e._e():n("Register",{attrs:{me:e.me},on:{registered:e.saveMe}}),e.editing?n("EditUser",{attrs:{me:e.me},on:{editeduser:e.saveMe}}):e._e(),n("header",{class:{blur:!e.registered||e.editing}},[n("h1",[e._v("platframe")]),n("Minimap",{attrs:{windowWidth:e.windowWidth,windowHeight:e.windowHeight,windowLeft:e.windowLeft,windowTop:e.windowTop,zoomIndex:e.zoomIndex},on:{newPosition:function(t){return e.scrollTo(t)}}}),n("div",{attrs:{id:"tools"}},[n("span",{staticClass:"title"},[e._v(" options ")]),n("div",{staticClass:"grid"},[n("input",{attrs:{type:"button",name:"grid",value:e.grid?"hide grid":"show grid"},on:{click:function(t){t.stopPropagation(),e.grid=!e.grid}}})]),n("div",{staticClass:"edituser"},[n("input",{attrs:{type:"button",name:"edituser",value:"edit appearance"},on:{click:function(t){t.stopPropagation(),e.editing=!0}}})]),n("div",{staticClass:"storage"},[n("input",{attrs:{type:"button",name:"storage",value:"delete me"},on:{click:function(t){return t.stopPropagation(),e.deleteMe()}}})]),n("div",{staticClass:"db"},[n("input",{attrs:{type:"button",name:"db",value:"delete everything"},on:{click:function(t){return t.stopPropagation(),e.announce("clear-db")}}})])]),n("div",{attrs:{id:"userList"}},[n("span",{staticClass:"title"},[e._v(" participants ")]),n("ul",[n("UserLabel",{attrs:{user:e.me,isMe:!0},nativeOn:{click:function(t){t.stopPropagation(),e.scrollTo(e.getUserPosition(e.me),"smooth")}}}),e._l(e.connectedUsersFirst(),(function(t){return n("UserLabel",{key:t.uid,attrs:{user:t},nativeOn:{click:function(n){n.stopPropagation(),e.scrollTo(e.getUserPosition(t),"smooth")}}})}))],2)])],1),n("div",{ref:"userlandContainer",class:{blur:!e.registered||e.editing},attrs:{id:"userlandContainer"}},[n("div",{ref:"userland",attrs:{id:"userland"}},[n("Grid",{attrs:{hidden:!e.grid}}),n("User",{key:e.me.uid,ref:"me",attrs:{user:e.me,isMe:!0}}),e._l(e.users,(function(e){return n("User",{key:e.uid,ref:"Users",refInFor:!0,attrs:{user:e}})}))],2)])],1)}),f=[],p=(n("99af"),n("c975"),n("b0c0"),n("07ac"),n("8a77")),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",{class:{hidden:e.hidden},attrs:{id:"grid"}},[n("tbody",e._l(e.y,(function(t){return n("Row",{key:t,attrs:{x:e.x}})})),1)])},h=[],g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",e._l(e.x,(function(e){return n("Cell",{key:e})})),1)},v=[],w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("td")},b=[],y={name:"Cell"},_=y,x=(n("fe21"),n("2877")),M=Object(x["a"])(_,w,b,!1,null,"7cdee33c",null),$=M.exports,O={name:"Row",components:{Cell:$},props:["x"]},C=O,k=Object(x["a"])(C,g,v,!1,null,"b5b15c9a",null),S=k.exports,j={name:"Grid",components:{Row:S},props:["hidden"],data:function(){return{y:50,x:50}}},P=j,E=(n("c779"),Object(x["a"])(P,m,h,!1,null,"5b97a78e",null)),L=E.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["user",e.user.uid,{me:e.isMe,disconnected:!e.user.connected}],style:{"--userColor":e.user.connected?e.user.color:"lightgrey"}},[n("Cursorr",{ref:"Cursor",attrs:{user:e.user,isMe:e.isMe,hovered:e.hovered},nativeOn:{mouseover:function(t){!e.isMe&&(e.hovered=!0)},mouseleave:function(t){e.hovered=!1}}}),e._l(e.user.messages,(function(t){return n("Message",{key:t.uid,ref:"Messages",refInFor:!0,attrs:{message:t,isMe:e.isMe,hovered:e.hovered},nativeOn:{mouseover:function(t){e.hovered=!0},mouseleave:function(t){e.hovered=!1}}})}))],2)},U=[],H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.user.uid?n("div",{class:["cursorContainer",{uid:e.user.uid,typing:e.user.typing||e.hovered}],style:{left:e.user.x-.2+"%",top:e.user.y-.2*.75+"%"}},[e.isMe?n("input",{ref:"input",staticClass:"input",attrs:{type:"text",placeholder:"type message & press enter",autofocus:""}}):n("span",{staticClass:"input"},[e._v(" "+e._s(e.user.typing)+" ")]),n("div",{staticClass:"cursor"},[e.user.typing||e.hovered?n("span",{staticClass:"name"},[e._v(" "+e._s(e.isMe?"me":e.user.connected?e.user.name:e.user.name+" (offline)")+" ")]):n("span",{staticClass:"name"})])]):e._e()},N=[],z={name:"Cursorr",components:{},props:["isMe","user","hovered"],data:function(){return{}},mounted:function(){},methods:{}},W=z,I=(n("4175"),Object(x["a"])(W,H,N,!1,null,"2b7f1fb4",null)),J=I.exports,R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.message.uid&&!e.message.deleted?n("div",{class:["messageContainer",e.message.uid,{hover:e.hovered}],style:{left:e.message.x+"%",top:e.message.y+"%","--blur":"blur("+(e.now-e.message.time)/1e8+"px)"}},[n("vue-markdown",{staticClass:"message"},[e._v(" "+e._s(e.message.content)+" ")]),n("span",{staticClass:"time"},[e._v(" "+e._s(e.fromNow(e.message.time))+" ")])],1):e._e()},D=[],F=n("f817"),B={name:"Message",components:{},props:["isMe","message","hovered"],data:function(){return{now:(new Date).getTime()}},mounted:function(){},methods:{fromNow:function(e){return Object(F["a"])(e).fromNow()}}},V=B,G=(n("f87e"),Object(x["a"])(V,R,D,!1,null,null,null)),Y=G.exports,A={name:"User",components:{Cursorr:J,Message:Y},props:["user","isMe"],data:function(){return{hovered:!1}},mounted:function(){},methods:{}},X=A,q=(n("e107"),Object(x["a"])(X,T,U,!1,null,"720746dc",null)),K=q.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{},attrs:{id:"registerContainer"}},[n("div",{attrs:{id:"register"}},[n("h3",[e._v("Welcome.")]),n("p",[e._v("To join the conversation, please pick a display name and color. You can change these later.")]),n("div",{staticClass:"form"},[n("input",{ref:"name",attrs:{type:"text",placeholder:"pick a display name"}}),n("input",{ref:"color",attrs:{type:"text","data-jscolor":""}}),n("input",{ref:"submit",attrs:{type:"button",value:"save"},on:{click:function(t){return e.save()}}})]),n("p",[e._v("This site does not use cookies. The information you are entering is stored in your browser and sent to all the other users.")])])])},Z=[],ee=n("881d"),te=n.n(ee),ne={name:"Register",props:["me"],data:function(){return{colorPickerOpts:{format:"rgba",previewPosition:"right",previewSize:30,borderRadius:0,padding:0,controlBorderColor:"rgba(255,255,255,0)",sliderSize:13,shadow:!1}}},mounted:function(){te.a.presets.default=this.colorPickerOpts,this.$refs.color.value=this.me.color},methods:{save:function(){var e={name:this.$refs.name.value,color:this.$refs.color.value};this.$emit("registered",e)}}},oe=ne,re=(n("816c"),Object(x["a"])(oe,Q,Z,!1,null,"3117eae4",null)),ie=re.exports,se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{},attrs:{id:"registerContainer"}},[n("div",{attrs:{id:"register"}},[n("div",{staticClass:"form"},[n("input",{ref:"name",attrs:{type:"text",placeholder:"pick a display name"}}),n("input",{ref:"color",attrs:{type:"text","data-jscolor":""}}),n("input",{ref:"submit",attrs:{type:"button",value:"save"},on:{click:function(t){return e.save()}}})])])])},ae=[],ce={name:"EditUser",props:["me"],data:function(){return{colorPickerOpts:{format:"rgba",previewPosition:"right",previewSize:30,borderRadius:0,padding:0,controlBorderColor:"rgba(255,255,255,0)",sliderSize:13,shadow:!1}}},mounted:function(){te.a.presets.default=this.colorPickerOpts,this.$refs.name.value=this.me.name,this.$refs.color.value=this.me.color},methods:{save:function(){var e={name:this.$refs.name.value,color:this.$refs.color.value};this.$emit("editeduser",e)}}},ue=ce,le=(n("e5d2"),Object(x["a"])(ue,se,ae,!1,null,"2fc13e45",null)),de=le.exports,fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{class:["userLabel",e.user.uid,{me:e.isMe}],style:{"--userColor":e.user.connected?e.user.color:"lightgrey"},on:{mouseover:function(t){e.hovered=!0},mouseleave:function(t){e.hovered=!1}}},[n("span",[e._v(" ● ")]),n("span",[e._v(" "+e._s(e.isMe?"me":e.user.name)+" ")]),n("span",[e._v(" "+e._s(e.hovered?"→":""))])])},pe=[],me={name:"UserLabel",components:{},props:["isMe","user"],data:function(){return{hovered:!1}},mounted:function(){},methods:{}},he=me,ge=(n("3f70"),Object(x["a"])(he,fe,pe,!1,null,"1e87f852",null)),ve=ge.exports,we=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"minimap"}},[n("Viewport",{directives:[{name:"dragged",rawName:"v-dragged",value:e.dragViewport,expression:"dragViewport"}],ref:"viewport",attrs:{id:"viewport",width:e.windowWidth/e.zoomIndex,height:e.windowHeight/e.zoomIndex,left:e.windowLeft/e.zoomIndex,top:e.windowTop/e.zoomIndex}})],1)},be=[],ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:{width:e.width+e.unit,height:e.height+e.unit,left:e.left+e.unit,top:e.top+e.unit}})},_e=[],xe={name:"Viewport",components:{},props:["width","height","left","top"],data:function(){return{unit:"px"}},mounted:function(){},methods:{}},Me=xe,$e=(n("5fb0"),Object(x["a"])(Me,ye,_e,!1,null,"0ef0d9c2",null)),Oe=$e.exports,Ce={name:"Minimap",components:{Viewport:Oe},props:["windowWidth","windowHeight","windowLeft","windowTop","zoomIndex"],data:function(){return{unit:"px"}},mounted:function(){},methods:{dragViewport:function(e){var t=e.deltaX,n=e.deltaY,o=e.first,r=e.last;if(o)this.dragging=!0;else if(r)this.dragging=!1;else{var i={x:this.windowLeft+t*this.zoomIndex,y:this.windowTop+n*this.zoomIndex};this.$emit("newPosition",i)}}}},ke=Ce,Se=(n("b5ae"),Object(x["a"])(ke,we,be,!1,null,"692b1e86",null)),je=Se.exports,Pe={name:"Userland",components:{Grid:L,Minimap:je,Register:ie,EditUser:de,User:K,UserLabel:ve},data:function(){return{me:{uid:Object(p["a"])(),connected:!1,name:"newUser-"+Object(p["a"])(),color:this.randomColor(),x:0,y:0,typing:null,messages:[]},users:{},doNotSave:!1,editing:!1,scrolling:!1,dragging:!1,registered:localStorage.me,visited:localStorage.uid,hasDB:localStorage.users,grid:!1,zoomIndex:25,windowWidth:window.innerWidth,windowHeight:window.innerHeight,windowLeft:null,windowTop:null}},created:function(){this.registered?this.me=JSON.parse(localStorage.me):this.visited?(this.me.uid=localStorage.uid,this.me.color=localStorage.color):(localStorage.uid=this.me.uid,localStorage.color=this.me.color),this.hasDB&&(this.users=JSON.parse(localStorage.users)),this.track()},mounted:function(){var e=this;c.a.polyfill(),window.addEventListener("resize",(function(){e.windowWidth=window.innerWidth,e.windowHeight=window.innerHeight}));var t=this.$refs.userlandContainer;this.windowLeft=t.scrollLeft,this.windowTop=t.scrollTop,t.addEventListener("scroll",(function(){e.windowLeft=t.scrollLeft,e.windowTop=t.scrollTop}));var n={x:(this.$refs.userland.offsetWidth-window.innerWidth)/2,y:(this.$refs.userland.offsetHeight-window.innerHeight)/2};this.scrollTo(n,"smooth")},sockets:{connect:function(){this.me.connected=!0,this.announce("user")},disconnect:function(){this.me.connected=!1,this.doNotSave||(localStorage.me=JSON.stringify(this.me))},broadcast:function(e){e=JSON.parse(e);var t=e.user,n=e.msg.type,o=e.msg.content;if(t.uid!==this.me.uid){this.$set(this.users,t.uid,t);var r=this.users[t.uid];"user"==n?this.announce("db",this.users):"position"==n||"typing"==n||"message"==n||"disconnect"==n&&(r.connected=!1)}if("db"==n){var i=o;for(var s in console.log("got DB from swarm: ",i),i){var a=i[s];s!==this.me.uid&&this.$set(this.users,s,a)}localStorage.users=JSON.stringify(this.users)}"clear-db"==n&&(this.users={},localStorage.users=JSON.stringify(this.users),this.me.messages=[],localStorage.me=JSON.stringify(this.me),window.location.reload(!0))}},methods:{announce:function(e,t){this.$socket.emit("pingServer",this.me,{type:e,content:t})},saveMe:function(e){this.me.name=e.name,this.me.color=e.color,this.announce("user"),this.registered=!0,this.editing=!1,localStorage.me=JSON.stringify(this.me)},deleteMe:function(){this.doNotSave=!0,localStorage.clear(),window.location.reload(!0)},constructMessage:function(e){var t=(new Date).getTime(),n={uid:this.me.uid+t,author:this.me.name,content:e,time:t,color:this.me.color,x:.4*Math.floor(this.me.x/.4),y:.4*Math.floor(this.me.y/.4)};return n},track:function(){var e,t,n=this;document.addEventListener("mousemove",(function(o){var r=n.$refs.userlandContainer;e=20*(r.scrollLeft+o.clientX)/r.offsetWidth,t=20*(r.scrollTop+o.clientY)/r.offsetHeight,n.$set(n.me,"x",e),n.$set(n.me,"y",t),n.announce("position"),o.preventDefault()}));var o,r=this.me.messages;document.addEventListener("keyup",(function(e){if(n.registered&&!n.editing){var t=n.$refs.me.$refs.Cursor.$refs.input,i=e.which||e.keyCode;if(t!==document.activeElement){if(i>=48&&i<=90){var s=String.fromCharCode(i);t.value=s}t.focus()}var a=n.constructMessage(t.value);n.me.typing=a.content,n.announce("typing");var c=r[0],u=r[r.length-1],l=r[r.indexOf(o)-1],d=r[r.indexOf(o)+1];27==i?(t.value="",t.blur()):38==i?o?l?(o=l,t.value=o.content,t.select()):(o=c,t.value=o.content):(o=u,t.value=o.content,t.select()):40==i?o&&d&&(o=d,t.value=o.content,t.select()):13==i&&a.content&&" "!=a.content&&(r.push(a),n.me.typing="",localStorage.me=JSON.stringify(n.me),n.announce("message",a),o=void 0,t.value="",t.placeholder=""),e.stopPropagation(),e.preventDefault()}})),document.addEventListener("click",(function(e){if(n.registered&&!n.editing){console.log("click");var t=n.$refs.me.$refs.Cursor.$refs.input,r=n.constructMessage(t.value);r.content&&" "!=r.content&&(n.me.messages.push(r),localStorage.me=JSON.stringify(n.me),n.announce("message",r),o=void 0,t.value="",t.placeholder=""),e.stopPropagation(),e.preventDefault()}}))},connectedUsersFirst:function(){var e=Object.values(this.users);e.sort((function(e,t){return e.connected===t.connected?0:e.connected?-1:1}));for(var t={},n=0;n<e.length;n++){var o=e[n];t[o.uid]=o}return t},getUserPosition:function(e){var t={x:.01*this.$refs.userland.offsetWidth*e.x-window.innerWidth/2,y:.01*this.$refs.userland.offsetHeight*e.y-window.innerHeight/2};return t},scrollTo:function(e,t){this.$refs.userlandContainer.scroll({left:e.x,top:e.y,behavior:t||"auto"})},randomColor:function(){var e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),n=Math.floor(256*Math.random()),o=1,r="rgb(".concat(e,", ").concat(t,", ").concat(n,", ").concat(o,")");return r}}},Ee=Pe,Le=(n("9fe0"),Object(x["a"])(Ee,d,f,!1,null,null,null)),Te=Le.exports,Ue={name:"Home",components:{Userland:Te},data:function(){return{loaded:!1,status:"loading...",isMobile:!!s.$root.isMobile}},created:function(){var e=this;s.$root.isMobile&&(this.isMobile=!0),this.$http.get(this.$apiURL+"/sessions").then((function(t){e.sessions=t.data,e.loaded=!0,e.msg="ready."})).catch((function(t){console.log(t),e.msg="there is an error :( contact karl <bonjour@moubarak.eu>"}))},mounted:function(){var e=this;this.$router.afterEach((function(t){e.slug=t.path.split("/")[1],e.handleRouting(e.slug)}))},methods:{handleRouting:function(e){e&&console.log(e)}}},He=Ue,Ne=(n("cccb"),Object(x["a"])(He,u,l,!1,null,null,null)),ze=Ne.exports,We={name:"App",components:{Home:ze},data:function(){return{isMobile:Boolean}},created:function(){this.CheckForMobile(),window.addEventListener("resize",this.CheckForMobile),c.a.polyfill()},methods:{CheckForMobile:function(){window.innerWidth<=760?(s.$root.isMobile=!0,this.isMobile=!0):(s.$root.isMobile=!1,this.isMobile=!1)}}},Ie=We,Je=(n("034f"),Object(x["a"])(Ie,r,i,!1,null,null,null)),Re=Je.exports,De=n("8c4f");o["a"].use(De["a"]);var Fe=[{path:"/",name:"Home",component:ze}],Be=new De["a"]({mode:"history",routes:Fe}),Ve=Be,Ge=n("bc3a"),Ye=n.n(Ge),Ae=n("0576"),Xe=n.n(Ae),qe=n("5132"),Ke=n.n(qe),Qe=n("8e27"),Ze=n.n(Qe),et=n("9ce6"),tt=n.n(et),nt=n("2699"),ot=n("a40a"),rt=n("dee2"),it=n("4e2b");n("6cc5");o["a"].component("l-map",nt["a"]),o["a"].component("l-tile-layer",ot["a"]),o["a"].component("l-grid-layer",rt["a"]),o["a"].component("l-marker",it["a"]);var st=Ze()("https://io.karls.computer");o["a"].use(Xe.a),o["a"].use(new Ke.a({connection:st})),tt.a.props.anchorAttributes.default=function(){return{target:"_blank",rel:"noopener noreferrer nofollow"}},o["a"].component("vue-markdown",tt.a),o["a"].prototype.$http=Ye.a,o["a"].prototype.$apiURL="https://api.obfuscation.karls.computer",o["a"].config.productionTip=!1,new o["a"]({router:Ve,render:function(e){return e(Re)}}).$mount("#app")},"5ced":function(e,t,n){},"5d27":function(e,t,n){},"5fb0":function(e,t,n){"use strict";n("b912")},"7aa6":function(e,t,n){},"7de5":function(e,t,n){},"816c":function(e,t,n){"use strict";n("16e7")},"85ec":function(e,t,n){},"9fe0":function(e,t,n){"use strict";n("7de5")},afbc:function(e,t,n){},b5ae:function(e,t,n){"use strict";n("7aa6")},b912:function(e,t,n){},bc8f:function(e,t,n){},c779:function(e,t,n){"use strict";n("ed49")},cccb:function(e,t,n){"use strict";n("5ced")},e107:function(e,t,n){"use strict";n("3b99")},e5d2:function(e,t,n){"use strict";n("054a")},ed49:function(e,t,n){},f87e:function(e,t,n){"use strict";n("afbc")},fe21:function(e,t,n){"use strict";n("5d27")}});
//# sourceMappingURL=app.597eb2de.js.map