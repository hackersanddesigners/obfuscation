(function(e){function t(t){for(var o,i,a=t[0],c=t[1],u=t[2],d=0,f=[];d<a.length;d++)i=a[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&f.push(r[i][0]),r[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);l&&l(t);while(f.length)f.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],o=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(o=!1)}o&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={app:0},s=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"11be":function(e,t,n){},"2d22":function(e,t,n){"use strict";n("2f84")},"2f84":function(e,t,n){},3393:function(e,t,n){"use strict";n("11be")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Home",{class:{mobile:e.isMobile}})],1)},s=[],i=new o["a"]({data:{isMobile:!1}}),a=n("7707"),c=n.n(a),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{hidden:!e.loaded},attrs:{id:"home"}},[n("Userland")],1)},l=[],d=(n("ac1f"),n("1276"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("header",[n("div",{staticClass:"tools"},[n("span",{staticClass:"title"},[e._v(" options ")]),n("div",{staticClass:"grid"},[n("input",{attrs:{type:"checkbox",name:"grid",checked:""},domProps:{value:e.grid},on:{click:function(t){return e.toggleGrid(t)}}}),n("label",{attrs:{for:"grid"}},[e._v("grid")])]),n("div",{staticClass:"storage"},[n("input",{attrs:{type:"button",name:"storage",value:"clear storage"},on:{click:function(t){return e.clearLocalStorage(t)}}})])]),n("div",{attrs:{id:"userList"}},[n("span",{staticClass:"title"},[e._v(" options ")]),n("ul",[n("UserLabel",{key:e.me.uid,attrs:{uid:e.me.uid,name:e.me.name,color:e.me.color,connected:e.me.connected,x:e.me.x,y:e.me.y,isMe:!0,typing:e.me.typing},nativeOn:{click:function(t){e.editing=!0}}}),e._l(e.users,(function(t){return n("UserLabel",{key:t.uid,attrs:{uid:t.uid,name:t.name,color:t.color,connected:t.connected,x:t.x,y:t.y,typing:t.typing},nativeOn:{click:function(n){return e.scrollToUser(t,n)}}})}))],2)])]),e.registered?e._e():n("Register",{attrs:{me:e.me},on:{registered:e.saveMe}}),e.editing?n("EditUser",{attrs:{me:e.me},on:{editeduser:e.saveMe}}):e._e(),n("div",{ref:"userlandContainer",attrs:{id:"userlandContainer"}},[n("div",{ref:"userland",attrs:{id:"userland"}},[n("Grid",{attrs:{hidden:!e.grid}}),e.me?n("User",{ref:"me",attrs:{uid:e.me.uid,name:e.me.name,color:e.me.color,isMe:!0,connected:e.me.connected,x:e.me.x,y:e.me.y,messages:e.me.messages}}):e._e(),e._l(e.users,(function(e){return n("User",{key:e.uid,ref:"Users",refInFor:!0,attrs:{uid:e.uid,name:e.name,color:e.color,connected:e.connected,x:e.x,y:e.y,typing:e.typing,messages:e.messages}})}))],2)])],1)}),f=[],m=(n("99af"),n("c975"),n("b0c0"),n("3835")),p=(n("96cf"),n("1da1")),h=n("8a77"),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",{class:{hidden:e.hidden},attrs:{id:"grid"}},[n("tbody",e._l(e.y,(function(t){return n("Row",{key:t,attrs:{x:e.x}})})),1)])},v=[],y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",e._l(e.x,(function(e){return n("Cell",{key:e})})),1)},b=[],x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("td")},M=[],_={name:"Cell"},w=_,k=(n("fe21"),n("2877")),$=Object(k["a"])(w,x,M,!1,null,"7cdee33c",null),C=$.exports,O={name:"Row",components:{Cell:C},props:["x"]},S=O,j=Object(k["a"])(S,y,b,!1,null,"b5b15c9a",null),P=j.exports,U={name:"Grid",components:{Row:P},props:["hidden"],data:function(){return{y:50,x:50}}},E=U,T=(n("c779"),Object(k["a"])(E,g,v,!1,null,"5b97a78e",null)),L=T.exports,R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["user",e.uid,{me:e.isMe}],style:{"--userColor":e.connected?e.color:"lightgrey"}},[n("Cursorr",{ref:"Cursor",attrs:{uid:e.uid,name:e.name,color:e.color,isMe:e.isMe,x:e.x,y:e.y,typing:e.typing,hovered:e.hovered,connected:e.connected},nativeOn:{mouseover:function(t){!e.isMe&&(e.hovered=!0)},mouseleave:function(t){e.hovered=!1}}}),e._l(e.messages,(function(t){return n("Message",{key:t.uid,ref:"Messages",refInFor:!0,attrs:{uid:t.uid,author:t.author,content:t.content,time:t.time,color:t.color,x:t.x,y:t.y,hovered:e.hovered},nativeOn:{mouseover:function(t){e.hovered=!0},mouseleave:function(t){e.hovered=!1}}})}))],2)},D=[],N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.uid?n("div",{staticClass:"cursorContainer",class:{uid:e.uid,typing:e.typing||e.hovered},style:{left:e.x-.2+"%",top:e.y-.2*.75+"%"}},[e.isMe?n("input",{ref:"input",staticClass:"input",attrs:{type:"text",placeholder:"type message & press enter",autofocus:""}}):n("span",{staticClass:"input"},[e._v(e._s(e.typing))]),n("div",{staticClass:"cursor"},[e.typing||e.hovered?n("span",{staticClass:"name"},[e._v(e._s(e.isMe?"me":e.connected?e.name:e.name+" (offline)"))]):n("span",{staticClass:"name"})])]):e._e()},J=[],B={name:"Cursorr",components:{},props:["uid","name","color","isMe","x","y","typing","hovered","connected"],data:function(){return{}},mounted:function(){},methods:{}},F=B,H=(n("6407"),Object(k["a"])(F,N,J,!1,null,"099229c7",null)),W=H.exports,z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.uid?n("div",{staticClass:"messageContainer",class:[e.uid,{hover:e.hovered}],style:{left:e.x+"%",top:e.y+"%","--blur":"blur("+(e.now-e.time)/1e7+"px)"}},[n("vue-markdown",{staticClass:"message"},[e._v(" "+e._s(e.content)+" ")]),n("span",{staticClass:"time"},[e._v(" "+e._s(e.fromNow(e.time))+" ")])],1):e._e()},G=[],I=n("f817"),A={name:"Message",components:{},props:["uid","author","isMe","content","time","color","x","y","hovered"],data:function(){return{now:(new Date).getTime()}},mounted:function(){},methods:{fromNow:function(e){return Object(I["a"])(e).fromNow()}}},V=A,Y=(n("f87e"),Object(k["a"])(V,z,G,!1,null,null,null)),K=Y.exports,X={name:"User",components:{Cursorr:W,Message:K},props:["uid","name","color","isMe","connected","x","y","typing","messages"],data:function(){return{hovered:!1}},mounted:function(){},methods:{}},q=X,Q=(n("2d22"),Object(k["a"])(q,R,D,!1,null,"50e8f73a",null)),Z=Q.exports,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{},attrs:{id:"registerContainer"}},[n("div",{attrs:{id:"register"}},[n("h3",[e._v("Welcome.")]),n("p",[e._v("To join the conversation, please pick a display name and color. You can change these later.")]),n("div",{staticClass:"form"},[n("input",{ref:"name",attrs:{type:"text",placeholder:"pick a display name"}}),n("input",{ref:"color",attrs:{type:"text","data-jscolor":""}}),n("input",{ref:"submit",attrs:{type:"button",value:"save"},on:{click:function(t){return e.save()}}})]),n("p",[e._v("This site does not use cookies. The information you are entering is stored in your browser and sent to all the other users.")])])])},te=[],ne=n("881d"),oe=n.n(ne),re={name:"Register",props:["me"],data:function(){return{colorPickerOpts:{format:"rgba",previewPosition:"right",previewSize:30,borderRadius:0,padding:0,controlBorderColor:"rgba(255,255,255,0)",sliderSize:13,shadow:!1}}},mounted:function(){oe.a.presets.default=this.colorPickerOpts,this.$refs.color.value=this.me.color},methods:{save:function(){var e={name:this.$refs.name.value,color:this.$refs.color.value};this.$emit("registered",e)}}},se=re,ie=(n("3393"),Object(k["a"])(se,ee,te,!1,null,"e9fb64f0",null)),ae=ie.exports,ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{},attrs:{id:"registerContainer"}},[n("div",{attrs:{id:"register"}},[n("div",{staticClass:"form"},[n("input",{ref:"name",attrs:{type:"text",placeholder:"pick a display name"}}),n("input",{ref:"color",attrs:{type:"text","data-jscolor":""}}),n("input",{ref:"submit",attrs:{type:"button",value:"save"},on:{click:function(t){return e.save()}}})])])])},ue=[],le={name:"EditUser",props:["me"],data:function(){return{colorPickerOpts:{format:"rgba",previewPosition:"right",previewSize:30,borderRadius:0,padding:0,controlBorderColor:"rgba(255,255,255,0)",sliderSize:13,shadow:!1}}},mounted:function(){oe.a.presets.default=this.colorPickerOpts,this.$refs.name.value=this.me.name,this.$refs.color.value=this.me.color},methods:{save:function(){var e={name:this.$refs.name.value,color:this.$refs.color.value};this.$emit("editeduser",e)}}},de=le,fe=(n("6fb9"),Object(k["a"])(de,ce,ue,!1,null,"4a81fda9",null)),me=fe.exports,pe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{class:["userLabel",e.uid,{me:e.isMe}],style:{"--userColor":e.connected?e.color:"lightgrey"},on:{mouseover:function(t){e.hovered=!0},mouseleave:function(t){e.hovered=!1}}},[n("span",[e._v(" "+e._s(e.isMe?"me":e.connected?e.name:e.name+" (offline)")+" ")]),!e.isMe&&e.hovered?n("span",[e._v(" → ")]):e.isMe&&e.hovered?n("span",[e._v(" → edit profile")]):e._e()])},he=[],ge={name:"UserLabel",components:{},props:["uid","name","color","isMe","connected","x","y","typing"],data:function(){return{hovered:!1}},mounted:function(){},methods:{}},ve=ge,ye=(n("7089"),Object(k["a"])(ve,pe,he,!1,null,"6d387a11",null)),be=ye.exports,xe={name:"Userland",components:{Grid:L,Register:ae,EditUser:me,User:Z,UserLabel:be},data:function(){return{me:{uid:Object(h["a"])(),connected:!1,name:"newUser-"+Object(h["a"])(),color:this.randomColor(),x:0,y:0,typing:String,messages:[]},registered:this.checkForMe(),visited:this.checkIfVisited(),editing:!1,scrolling:!1,users:{},storedUsers:{},connectedUsers:{},grid:!0}},created:function(){this.registered?this.me=JSON.parse(localStorage.me):this.visited?(this.me.uid=localStorage.uid,this.me.color=localStorage.color):(localStorage.uid=this.me.uid,localStorage.color=this.me.color),this.track(this.me),this.checkForDB()&&(this.users=JSON.parse(localStorage.users))},mounted:function(){var e=this;c.a.polyfill();var t=this.$refs.userlandContainer;t.addEventListener("scroll",(function(t){e.scrolling=!0,t.preventDefault(),e.scrolling=!1}));var n={x:(this.$refs.userland.offsetWidth-window.innerWidth)/2,y:(this.$refs.userland.offsetHeight-window.innerHeight)/2};t.scroll({left:n.x,top:n.y,behavior:"smooth"})},sockets:{connect:function(){this.me.connected=!0,this.announceUser()},disconnect:function(){this.me.connected=!1},dbSync:function(e){console.log(e)},broadcast:function(e){var t=this;return Object(p["a"])(regeneratorRuntime.mark((function n(){var o,r,s,i,a,c,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e=JSON.parse(e),o=e.user,r=e.msg.type,s=e.msg.content,o.uid!==t.me.uid&&(t.$set(t.users,o.uid,o),i=t.users[o.uid],"user"==r?t.announceDB():"position"==r||"typing"==r||"message"==r||"disconnect"==r&&(i.connected=!1)),"db"==r){for(c in a=s,a)u=a[c],c!==t.me.uid&&t.$set(t.users,c,u);t.saveDB()}case 6:case"end":return n.stop()}}),n)})))()}},methods:{checkForMe:function(){if(localStorage.me)return!0;console.log("you've been here before.")},checkIfVisited:function(){if(localStorage.uid)return!0;console.log("you're new.")},checkForDB:function(){if(localStorage.users)return!0;console.log("you haven't made a userDb yet.")},saveMe:function(e){this.me.name=e.name,this.me.color=e.color,this.announceUser(),this.registered=!0,this.editing=!1,localStorage.me=JSON.stringify(this.me)},saveDB:function(){localStorage.users=JSON.stringify(this.users)},announceUser:function(){this.sendToPeers({type:"user",content:""})},announcePosition:function(){this.sendToPeers({type:"position",content:""})},announceTyping:function(e){this.sendToPeers({type:"typing",content:e})},announceMessage:function(e){this.sendToPeers({type:"message",content:e})},announceDB:function(){this.sendToPeers({type:"db",content:this.users})},sendToPeers:function(e){this.$socket.emit("pingServer",this.me,e)},scrollToUser:function(e,t){var n={x:.01*this.$refs.userland.offsetWidth*e.x-window.innerWidth/2,y:.01*this.$refs.userland.offsetHeight*e.y-window.innerHeight/2};this.$refs.userlandContainer.scroll({left:n.x,top:n.y,behavior:"smooth"}),t.stopPropagation()},constructMessage:function(e){var t=(new Date).getTime(),n={uid:this.me.uid+t,author:this.me.name,content:e,time:t,color:this.me.color,x:.4*Math.floor(this.me.x/.4),y:.4*Math.floor(this.me.y/.4)};return n},track:function(e){var t,n,o,r=this;e.uid==this.me.uid&&(document.addEventListener("mousemove",(function(e){var o=r.$refs.userlandContainer;t=20*(o.scrollLeft+e.clientX)/o.offsetWidth,n=20*(o.scrollTop+e.clientY)/o.offsetHeight,r.$set(r.me,"x",t),r.$set(r.me,"y",n),r.announcePosition(r.me),e.preventDefault()})),document.addEventListener("keyup",(function(e){if(r.registered&&!r.editing){var t=r.$refs.me.$refs.Cursor.$refs.input,n=e.which||e.keyCode,s=r.computeMessages(r.me.messages,o),i=Object(m["a"])(s,4),a=i[0],c=i[1],u=i[2],l=i[3];if(t!==document.activeElement){if(n>=48&&n<=90){var d=String.fromCharCode(n);t.value=d}t.focus()}var f=r.constructMessage(t.value);r.me.typing=f.content,r.announceTyping(f),27==n?(t.value="",t.blur()):38==n?o?u?(o=u,t.value=o.content,t.select()):(o=a,t.value=o.content):(o=c,t.value=o.content,t.select()):40==n?o&&l&&(o=l,t.value=o.content,t.select()):13!=n||e.shiftKey||f.content&&" "!=f.content&&(t.value=t.value-"\n",r.me.messages.push(f),r.me.typing="",localStorage.me=JSON.stringify(r.me),r.announceMessage(f),o=void 0,t.value="",t.placeholder=""),e.preventDefault()}})),document.addEventListener("click",(function(e){if(r.registered){console.log("send");var t=r.$refs.me.$refs.Cursor.$refs.input,n=r.constructMessage(t.value);n.content&&" "!=n.content&&(r.me.messages.push(n),localStorage.me=JSON.stringify(r.me),r.announceMessage(n),o=void 0,t.value="",t.placeholder=""),e.stopPropagation(),e.preventDefault()}})))},computeMessages:function(e,t){var n=e[0],o=e[e.length-1],r=e[e.indexOf(t)-1],s=e[e.indexOf(t)+1];return[n,o,r,s]},clearLocalStorage:function(e){console.log("clearing storage"),localStorage.clear(),window.location.reload(!0),e.stopPropagation()},clearMessages:function(e){this.me.messages=[],this.me.typing="",localStorage.me=JSON.stringify(this.me),e.stopPropagation()},toggleGrid:function(e){this.grid=!this.grid,e.stopPropagation()},randomColor:function(){var e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),n=Math.floor(256*Math.random()),o=1,r="rgb(".concat(e,", ").concat(t,", ").concat(n,", ").concat(o,")");return r}}},Me=xe,_e=(n("9fe0"),Object(k["a"])(Me,d,f,!1,null,null,null)),we=_e.exports,ke={name:"Home",components:{Userland:we},data:function(){return{loaded:!1,status:"loading...",isMobile:!!i.$root.isMobile}},created:function(){var e=this;i.$root.isMobile&&(this.isMobile=!0),this.$http.get(this.$apiURL+"/sessions").then((function(t){e.sessions=t.data,e.loaded=!0,e.msg="ready."})).catch((function(t){console.log(t),e.msg="there is an error :( contact karl <bonjour@moubarak.eu>"}))},mounted:function(){var e=this;this.$router.afterEach((function(t){e.slug=t.path.split("/")[1],e.handleRouting(e.slug)}))},methods:{handleRouting:function(e){e&&console.log(e)}}},$e=ke,Ce=(n("cccb"),Object(k["a"])($e,u,l,!1,null,null,null)),Oe=Ce.exports,Se={name:"App",components:{Home:Oe},data:function(){return{isMobile:Boolean}},created:function(){this.CheckForMobile(),window.addEventListener("resize",this.CheckForMobile),c.a.polyfill()},methods:{CheckForMobile:function(){window.innerWidth<=760?(i.$root.isMobile=!0,this.isMobile=!0):(i.$root.isMobile=!1,this.isMobile=!1)}}},je=Se,Pe=(n("034f"),Object(k["a"])(je,r,s,!1,null,null,null)),Ue=Pe.exports,Ee=n("8c4f");o["a"].use(Ee["a"]);var Te=[{path:"/",name:"Home",component:Oe}],Le=new Ee["a"]({mode:"history",routes:Te}),Re=Le,De=n("bc3a"),Ne=n.n(De),Je=n("5132"),Be=n.n(Je),Fe=n("8e27"),He=n.n(Fe),We=n("9ce6"),ze=n.n(We),Ge=n("2699"),Ie=n("a40a"),Ae=n("dee2"),Ve=n("4e2b");n("6cc5");o["a"].component("l-map",Ge["a"]),o["a"].component("l-tile-layer",Ie["a"]),o["a"].component("l-grid-layer",Ae["a"]),o["a"].component("l-marker",Ve["a"]);var Ye=He()("https://io.karls.computer");o["a"].use(new Be.a({connection:Ye})),ze.a.props.anchorAttributes.default=function(){return{target:"_blank",rel:"noopener noreferrer nofollow"}},o["a"].component("vue-markdown",ze.a),o["a"].prototype.$http=Ne.a,o["a"].prototype.$apiURL="https://api.obfuscation.karls.computer",new o["a"]({router:Re,render:function(e){return e(Ue)}}).$mount("#app")},"5ced":function(e,t,n){},"5d27":function(e,t,n){},6407:function(e,t,n){"use strict";n("cbed")},"6fb9":function(e,t,n){"use strict";n("f8c4")},7089:function(e,t,n){"use strict";n("c040")},"7de5":function(e,t,n){},"85ec":function(e,t,n){},"9fe0":function(e,t,n){"use strict";n("7de5")},afbc:function(e,t,n){},c040:function(e,t,n){},c779:function(e,t,n){"use strict";n("ed49")},cbed:function(e,t,n){},cccb:function(e,t,n){"use strict";n("5ced")},ed49:function(e,t,n){},f87e:function(e,t,n){"use strict";n("afbc")},f8c4:function(e,t,n){},fe21:function(e,t,n){"use strict";n("5d27")}});
//# sourceMappingURL=app.84f12d09.js.map