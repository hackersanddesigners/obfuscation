(function(e){function t(t){for(var s,r,a=t[0],c=t[1],u=t[2],d=0,m=[];d<a.length;d++)r=a[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&m.push(o[r][0]),o[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);l&&l(t);while(m.length)m.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],s=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(s=!1)}s&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var s={},o={app:0},i=[];function r(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=s,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"0ccf":function(e,t,n){"use strict";n("c4ca")},"101a":function(e,t,n){},"17c3":function(e,t,n){"use strict";n("6f36")},1812:function(e,t,n){"use strict";n("101a")},"211f":function(e,t,n){"use strict";n("9383")},"2d9b":function(e,t,n){},3171:function(e,t,n){},"31ad":function(e,t,n){},"32a0":function(e,t,n){"use strict";n("5d18")},3392:function(e,t,n){},"3cd2":function(e,t,n){"use strict";n("9a7c")},"495b":function(e,t,n){"use strict";n("3171")},"4a60":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),o=n("bc3a"),i=n.n(o),r=n("5132"),a=n.n(r),c=n("8e27"),u=n.n(c),l=n("9ce6"),d=n.n(l),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Home",{attrs:{slug:e.slug}})],1)},f=[],g=(n("ac1f"),n("5319"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"home"}},[e.blocked?n("Nomansland"):n("Mainland",{attrs:{wantsToView:e.wantsToView}})],1)}),h=[],p=(n("fb6a"),n("2ca0"),n("2f62")),v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:e.userColors},[n("header",{class:{blur:!e.registered||e.editing}},[n("Minimap",{attrs:{dragging:e.dragging,miniDragging:e.miniDragging},on:{miniDragging:function(t){e.miniDragging=!0},miniStopDragging:function(t){e.miniDragging=!1},newPosition:function(t){return e.scrollTo(t,e.miniDragging?"auto":"smooth")},zero:e.centerMe}}),n("Options",{attrs:{editing:e.editing,name:e.me.name,color:e.me.color,usernames:e.userNames},on:{editMe:function(t){e.editing=!0},newColor:e.updateColor,newMe:e.updateAppearance,register:e.saveMe,deleteMe:e.deleteMe,deleteEverything:e.deleteEverything}}),n("Userslist",{on:{censorMessage:function(t){return e.censorMessage(t)},deleteMessage:function(t){return e.deleteMessage(t)},deleteUser:function(t){return e.deleteUser(t)},goTo:function(t){e.scrollTo(e.positionOf(t),"smooth")}}})],1),n("div",{ref:"userlandContainer",class:{blur:!e.registered||e.editing,dragging:e.dragging},attrs:{id:"userlandContainer"},on:{scroll:function(t){return e.setViewerPosition()}}},[n("div",{ref:"userland",style:{height:100*e.scale+"%",width:100*e.scale+"%","--scale":e.scale},attrs:{id:"userland"},on:{mousedown:function(t){t.stopPropagation(),e.dragging=!0},mousemove:function(t){e.dragging&&e.drag(t)},mouseup:function(t){t.stopPropagation(),e.dragging=!1}}},[n("Grid"),e._l(e.notDeletedUsers,(function(t){return n("Cursorr",{key:t.uid,ref:e.isMe(t)?"me":"Users",refInFor:!0,attrs:{user:t,isMe:e.isMe(t),hovered:e.hovered,dragging:e.isMe(t)?e.dragging:null},on:{newPosition:e.updatePosition},nativeOn:{mouseover:function(n){!e.isMe(t)&&(e.hovered=!0)},mouseleave:function(t){e.hovered=!1}}})})),e._l(e.notDeletedMessages,(function(t){return n("Message",{key:t.uid,ref:"Messages",refInFor:!0,attrs:{message:t,isMe:t.author===e.me.uid},on:{deleteMessage:function(t){return e.deleteMessage(t)}},nativeOn:{mouseover:function(t){e.hovered=!0},mouseleave:function(t){e.hovered=!1}}})})),e._l(e.islands,(function(e){return n("Territory",{key:e.name,attrs:{name:e.name,borders:e.borders}})}))],2)])])},w=[],b=(n("99af"),n("4160"),n("c975"),n("b0c0"),n("b64b"),n("159b"),n("5530")),y=n("8a77"),$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",{class:{hidden:e.hidden},attrs:{id:"grid"}},[n("tbody",e._l(e.scale*e.definition,(function(t){return n("Row",{key:t,attrs:{x:e.scale*e.definition}})})),1)])},_=[],O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",e._l(e.x,(function(e){return n("Cell",{key:e})})),1)},M=[],C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("td")},x=[],k={name:"Cell"},S=k,T=(n("7138"),n("2877")),j=Object(T["a"])(S,C,x,!1,null,"825c3c98",null),P=j.exports,U={name:"Row",components:{Cell:P},props:["x"]},N=U,D=Object(T["a"])(N,O,M,!1,null,"4ed0d323",null),E=D.exports,L={name:"Table",components:{Row:E},props:[],data:function(){return{scale:10,definition:10}},computed:{hidden:function(){return!this.$store.state.grid}}},B=L,z=(n("c9ef"),Object(T["a"])(B,$,_,!1,null,"421308ca",null)),J=z.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{hovered:e.hovered||e.dragging},style:{height:e.height+"px",width:e.width+"px"},attrs:{id:"minimap"},on:{mouseover:function(t){e.hovered=!0},mouseout:function(t){e.hovered=!1},mousedown:function(t){e.sendDesiredPosition(t),e.$emit("miniDragging")},mousemove:function(t){e.miniDragging&&e.sendDesiredPosition(t)},mouseup:function(t){e.$emit("miniStopDragging"),e.sendDesiredPosition(t)}}},[e._l(e.users,(function(t){return n("Cursorr",{key:t.uid,attrs:{user:t,scale:e.scale}})})),e._l(e.messages,(function(t){return n("Message",{key:t.uid,attrs:{message:t,hovered:e.hovered,dragging:e.dragging}})})),e._l(e.islands,(function(e){return n("Territory",{key:e.name,attrs:{name:e.name,borders:e.borders}})})),n("Window",{ref:"viewport",attrs:{id:"viewport",width:e.width/e.scale,height:e.height/e.scale,left:e.left/e.scale,top:e.top/e.scale}}),n("div",{staticClass:"zoom"},[n("div",{staticClass:"in",on:{mousedown:function(t){return t.stopPropagation(),e.$store.commit("zoomIn")},mouseup:function(e){e.stopPropagation()}}},[e._v("+")]),n("div",{staticClass:"out",on:{mousedown:function(t){return t.stopPropagation(),e.$store.commit("zoomOut")},mouseup:function(e){e.stopPropagation()}}},[e._v("-")]),n("div",{staticClass:"zero",on:{mousedown:function(t){return t.stopPropagation(),e.$emit("zero")},mouseup:function(e){e.stopPropagation()}}},[e._v("○")])])],2)},I=[],V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["cursorContainer",{uid:e.user.uid,hovered:!e.scale&&(e.user.typing||e.hovered),dragging:e.dragging}],style:{left:100*e.user.x-.1+"%",top:100*e.user.y-.2+"%","--scale":e.scale?3:15,"--userColor":"var(--"+e.user.uid+")"}},[!e.scale&&e.isMe?n("input",{ref:"input",staticClass:"input",attrs:{type:"text",placeholder:"type message & press enter",autofocus:""}}):e.scale?e._e():n("span",{staticClass:"input"},[e._v(" "+e._s(e.user.typing)+" ")]),n("div",{staticClass:"cursor"},[e.scale||!e.user.typing&&!e.hovered?e.scale?e._e():n("span",{staticClass:"name"}):n("span",{staticClass:"name"},[e._v(" "+e._s(e.isMe?"me":e.user.connected?e.user.name:e.user.name+" (offline)")+" ")])])])},W=[],X={name:"Cursorr",components:{},props:["user","isMe","scale","hovered","dragging"],data:function(){return{}},mounted:function(){this.isMe&&!this.scale&&this.trackCursor()},methods:{trackCursor:function(){var e=this;document.addEventListener("mousemove",(function(t){e.$emit("newPosition",{x:t.clientX,y:t.clientY}),t.preventDefault()}))}}},A=X,R=(n("17c3"),Object(T["a"])(A,V,W,!1,null,"0bed9ace",null)),F=R.exports,Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["minimessage",{clear:e.hovered||e.dragging}],style:{left:e.toNearestX(e.message.x,.4)+"%",top:e.toNearestX(e.message.y,.4)+"%",width:e.message.content.length/2+"px","--blur":"blur("+(e.now-e.message.time)/1e8+"px)","--userColor":"var(--"+e.message.author+")"}})},G=[],K=n("f817"),Z={name:"Message",components:{},props:["message","hovered","dragging"],data:function(){return{now:(new Date).getTime()}},mounted:function(){},methods:{fromNow:function(e){return Object(K["a"])(e).fromNow()},toNearestX:function(e,t){return Math.floor(100*e/t)*t}}},q=Z,Q=(n("0ccf"),Object(T["a"])(q,Y,G,!1,null,null,null)),ee=Q.exports,te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"miniterritory",style:{left:e.toNearestX(e.borders.x,.4)+"%",top:e.toNearestX(e.borders.y,.4)+"%",width:"20%",height:"20%"},attrs:{id:"mini-"+e.name}},[n("div",{staticClass:"box"})])},ne=[],se={name:"Territory",components:{},props:["name","borders"],data:function(){return{}},mounted:function(){},methods:{toNearestX:function(e,t){return Math.floor(100*e/t)*t}}},oe=se,ie=(n("3cd2"),Object(T["a"])(oe,te,ne,!1,null,null,null)),re=ie.exports,ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:{width:e.width+e.unit,height:e.height+e.unit,left:e.left+e.unit,top:e.top+e.unit}})},ce=[],ue={name:"Window",components:{},props:["width","height","left","top"],data:function(){return{unit:"px"}},mounted:function(){},methods:{}},le=ue,de=(n("fb59"),Object(T["a"])(le,ae,ce,!1,null,"6916f9b4",null)),me=de.exports,fe={name:"Map",components:{Cursorr:F,Message:ee,Territory:re,Window:me},props:["dragging","miniDragging"],data:function(){return{hovered:!1}},computed:Object(b["a"])(Object(b["a"])({},Object(p["c"])({islands:function(e){return e.islands},left:function(e){return e.windowLeft/5},top:function(e){return e.windowTop/5},width:function(e){return e.windowWidth/5},height:function(e){return e.windowHeight/5},scale:function(e){return e.scale},zoomIndex:function(e){return 5*e.scale}})),Object(p["b"])({users:"notDeletedUsers",messages:"notDeletedMessages"})),watch:{},mounted:function(){},methods:{sendDesiredPosition:function(e){var t=e.pageX-this.$el.offsetLeft,n=this.width/(2*this.scale),s=(t-n)*this.zoomIndex,o=e.pageY-this.$el.offsetTop,i=this.height/(2*this.scale),r=(o-i)*this.zoomIndex;this.$emit("newPosition",{x:s,y:r})}}},ge=fe,he=(n("919f"),Object(T["a"])(ge,H,I,!1,null,"fd1332aa",null)),pe=he.exports,ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"options"}},[!e.registered||e.editing?n("Register",{attrs:{registered:e.registered,name:e.name,color:e.color,usernames:e.usernames},on:{newMe:function(t){return e.$emit("newMe",t)},newColor:function(t){return e.$emit("newColor",t)},register:function(t){return e.$emit("register",t)}}}):e._e(),n("span",{staticClass:"title"},[e._v(" options ")]),n("div",{staticClass:"grid"},[n("input",{attrs:{type:"button",name:"grid",value:e.grid?"hide grid":"show grid"},on:{click:function(t){return t.stopPropagation(),e.$store.commit("toggleGrid")}}})]),n("div",{staticClass:"edituser"},[n("input",{attrs:{type:"button",name:"edituser",value:"edit appearance"},on:{click:function(t){return t.stopPropagation(),e.$emit("editMe")}}})]),n("div",{staticClass:"storage"},[n("input",{attrs:{type:"button",name:"storage",value:"delete me"},on:{click:function(t){return t.stopPropagation(),e.$emit("deleteMe")}}})]),n("div",{staticClass:"db"},[n("input",{attrs:{type:"button",name:"db",value:"delete everything"},on:{click:function(t){return t.stopPropagation(),e.$emit("deleteEverything")}}})])],1)},we=[],be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{},attrs:{id:"registerContainer"}},[n("div",{attrs:{id:"register"}},[e.registered?e._e():n("div",{staticClass:"introText"},[n("h3",[e._v("Welcome.")]),n("p",[e._v("To join the conversation, please pick a display name and color. You can change these later.")])]),n("div",{staticClass:"form"},[n("input",{ref:"name",attrs:{type:"text",placeholder:"pick a display name"}}),e.invalid?n("p",{staticClass:"error"},[e._v("Your display name cannot contain any spaces or special characters. ")]):e.tooshort?n("p",{staticClass:"error"},[e._v("Your display name must contain at least 3 characters. ")]):e.inuse?n("p",{staticClass:"error"},[e._v("This name has already been taken by someone else. ")]):e._e(),n("input",{ref:"color",attrs:{type:"text","data-jscolor":""},on:{input:e.updateColor}}),n("input",{ref:"submit",attrs:{type:"button",value:"save"},on:{click:function(t){return t.stopPropagation(),e.save()}}})]),e.registered?e._e():n("div",{staticClass:"introText"},[n("p",[e._v("This site does not use cookies. The information you are entering is stored in your browser and sent to all the other users.")])])])])},ye=[],$e=(n("4d63"),n("25f0"),n("881d")),_e=n.n($e),Oe={name:"Register",props:["name","color","registered","usernames"],data:function(){return{colorPickerOpts:{format:"rgba",previewPosition:"right",previewSize:30,borderRadius:0,padding:0,controlBorderColor:"rgba(255,255,255,0)",sliderSize:13,shadow:!1},invalid:!1,tooshort:!1,inuse:!1}},mounted:function(){var e=this;_e.a.presets.default=this.colorPickerOpts,this.$refs.color.value=this.color,_e.a.init(),this.registered&&(this.$refs.name.value=this.name,this.$refs.name.select()),this.$nextTick((function(){e.registered&&new _e.a(e.$refs.color)}))},methods:{save:function(){var e=this.$refs.name.value,t=this.$refs.color.value;this.validateChars(e)?this.validateLength(e)?this.existingUser(e)?this.inuse=!0:this.registered?this.updateAppearance(e,t):this.register(e,t):this.tooshort=!0:this.invalid=!0},cancel:function(){this.$emit("newMe",{name:this.name,color:this.color})},updateAppearance:function(e,t){this.$emit("newMe",{name:e,color:t})},updateColor:function(){this.$emit("newColor",{color:this.$refs.color.value})},register:function(e,t){this.$emit("register",{name:e,color:t})},validateChars:function(e){return/^[A-Za-z0-9]+(?:-[A-Za-z0-9]+)*$/.test(e)},validateLength:function(e){return e.length>1},existingUser:function(e){return this.usernames.indexOf(e)>-1&&e!==this.name},toSlug:function(e){e=e.replace(/^\s+|\s+$/g,""),e=e.toLowerCase();for(var t="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",n="aaaaeeeeiiiioooouuuunc------",s=0,o=t.length;s<o;s++)e=e.replace(new RegExp(t.charAt(s),"g"),n.charAt(s));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),e}}},Me=Oe,Ce=(n("e749"),Object(T["a"])(Me,be,ye,!1,null,"2749fc1e",null)),xe=Ce.exports,ke={name:"Options",components:{Register:xe},props:["editing","name","color","usernames"],data:function(){return{}},computed:{registered:function(){return this.$store.state.registered},grid:function(){return this.$store.state.grid}},mounted:function(){},methods:{}},Se=ke,Te=(n("495b"),Object(T["a"])(Se,ve,we,!1,null,"430714e9",null)),je=Te.exports,Pe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{moderating:e.moderating},attrs:{id:"userlistContainer"}},[n("div",{attrs:{id:"userlist"}},[n("span",{staticClass:"title"},[n("span",[e._v("participants")]),n("div",{attrs:{id:"moderate"}},[n("span",{staticClass:"moderateButton",on:{click:function(t){e.moderating?e.moderating=!1:e.moderator?e.moderating=!0:e.authenticating?e.authenticating=!1:e.authenticating=!0}}},[e.moderating?n("span",[e._v("—")]):n("span",[e._v("M")])]),e.authenticating?n("input",{ref:"password",attrs:{type:"password",name:"moderator",placeholder:"moderator password",autofocus:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.authenticate()}}}):e._e()])]),n("ul",e._l(e.connectedUsersFirst,(function(t){return n("Label",{key:t.uid,attrs:{user:t,isMe:t.uid===e.me.uid,moderating:e.moderating,messages:e.messagesByUser(t)},on:{censorMessage:function(t){return e.$emit("censorMessage",t)},deleteMessage:function(t){return e.$emit("deleteMessage",t)},deleteUser:function(t){return e.$emit("deleteUser",t)},goTo:function(t){return e.$emit("goTo",t)}},nativeOn:{click:function(n){return n.stopPropagation(),e.$emit("goTo",t)}}})})),1)])])},Ue=[],Ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{class:["userLabel",e.user.uid,{me:e.isMe}],style:{"--userColor":e.user.connected?e.user.color:"lightgrey"},on:{mouseover:function(t){t.stopPropagation(),e.hovered=!0},mouseleave:function(t){t.stopPropagation(),e.hovered=!1}}},[n("span",{staticClass:"bullet"},[e._v(" ● ")]),n("span",{staticClass:"name"},[e._v(" "+e._s(e.isMe?"me":e.user.name)+" ")]),e.moderating?n("div",{staticClass:"moderatorOptions"},[n("span",{staticClass:"messages",on:{click:function(t){t.stopPropagation(),e.messagesVisible=!e.messagesVisible}}},[e._v("messages")]),n("span",{staticClass:"delete",on:{click:function(t){return t.stopPropagation(),e.$emit("deleteUser",e.user)}}},[e._v("delete")])]):e._e(),n("span",{staticClass:"goto"},[e._v(" "+e._s(e.hovered?"→":""))]),e.moderating&&e.messagesVisible?n("div",{staticClass:"messageListContiner"},[e.messages.length>0?n("ul",{staticClass:"messageList"},e._l(e.messages,(function(t){return n("MessageOptions",{key:t.uid,attrs:{message:t},on:{censorMessage:function(n){return e.$emit("censorMessage",t)},deleteMessage:function(n){return e.$emit("deleteMessage",t)}},nativeOn:{click:function(n){return n.stopPropagation(),e.$emit("goTo",t)}}})})),1):n("p",[e._v("This user has no messaages.")])]):e._e()])},De=[],Ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["miniMessageContainer",{hover:e.hovered}],on:{mouseover:function(t){e.hovered=!0},mouseleave:function(t){e.hovered=!1}}},[n("span",{staticClass:"message"},[e._v(" "+e._s(e.message.content)+" ")]),n("span",{staticClass:"time"},[e._v(" "+e._s(e.format(e.message.time))+" ")]),n("span",{staticClass:"delete",on:{click:function(t){return t.stopPropagation(),e.$emit("deleteMessage",e.message)}}},[e._v("delete")]),e.message.censored?n("span",{staticClass:"delete",on:{click:function(t){return t.stopPropagation(),e.$emit("censorMessage",e.message)}}},[e._v("uncensor")]):n("span",{staticClass:"delete",on:{click:function(t){return t.stopPropagation(),e.$emit("censorMessage",e.message)}}},[e._v("censor")]),n("span",{staticClass:"goto"},[e._v(" "+e._s(e.hovered?"→":""))])])},Le=[],Be={name:"MessageOptions",components:{},props:["message"],data:function(){return{now:(new Date).getTime(),hovered:!1}},mounted:function(){},methods:{format:function(e){return Object(K["a"])(e).format("MMM Do @ HH:mm:ss ")}}},ze=Be,Je=(n("8ceb"),Object(T["a"])(ze,Ee,Le,!1,null,"6f895794",null)),He=Je.exports,Ie={name:"Label",components:{MessageOptions:He},props:["isMe","user","messages","moderating"],data:function(){return{hovered:!1,messagesVisible:!1}},mounted:function(){},methods:{}},Ve=Ie,We=(n("211f"),Object(T["a"])(Ve,Ne,De,!1,null,"2b50ba08",null)),Xe=We.exports,Ae={name:"List",components:{Label:Xe},props:[],data:function(){return{moderator:!1,authenticating:!1,moderating:!1}},computed:Object(b["a"])({},Object(p["b"])({me:"me",users:"notDeletedUsers",messages:"notDeletedMessages",messagesByUser:"messagesByUser",connectedUsersFirst:"connectedUsersFirst"})),mounted:function(){},methods:{authenticate:function(){var e=this.$refs.password.value;"0000"===e&&(this.moderator=!0,this.authenticating=!1,this.moderating=!0)}}},Re=Ae,Fe=(n("a6c4"),Object(T["a"])(Re,Pe,Ue,!1,null,"656cc583",null)),Ye=Fe.exports,Ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.message.navigation?e._e():n("div",{class:["messageContainer",{hover:e.hovered,announcement:e.message.announcement}],style:{left:e.toNearestX(e.message.x,.4)+"%",top:e.toNearestX(e.message.y,.4)+"%","--blur":"blur("+(e.now-e.message.time)/1e8+"px)","--userColor":"var(--"+e.message.author+")"},attrs:{id:e.message.uid},on:{mouseover:function(t){e.hovered=!0},mouseleave:function(t){e.hovered=!1}}},[e.message.censored?n("div",{staticClass:"message censored"},[e._v(" This message has been censored by a moderator. ")]):n("vue-markdown",{staticClass:"message"},[e._v(" "+e._s(e.message.content)+" ")]),n("span",{staticClass:"time"},[e._v(" "+e._s(e.fromNow(e.message.time))+" ")]),e.isMe?n("span",{staticClass:"delete",on:{click:function(t){return t.stopPropagation(),e.$emit("deleteMessage",e.message)}}},[e._v(" delete ")]):e._e()],1)},Ke=[],Ze={name:"Message",components:{},props:["isMe","message"],data:function(){return{now:(new Date).getTime(),hovered:!1}},mounted:function(){},methods:{fromNow:function(e){return Object(K["a"])(e).fromNow()},toNearestX:function(e,t){return Math.floor(100*e/t)*t}}},qe=Ze,Qe=(n("fd40"),Object(T["a"])(qe,Ge,Ke,!1,null,null,null)),et=Qe.exports,tt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"territory",style:{left:e.toNearestX(e.borders.x,.4)+"%",top:e.toNearestX(e.borders.y,.4)+"%",width:"20%",height:"20%"},attrs:{id:e.name}},[n("Island",{attrs:{name:e.name,content:e.content},on:{more:function(t){e.$router.push("#"+e.name),e.more=!0}}}),n("Overlay",{class:{hidden:!e.more},attrs:{content:e.content},on:{less:function(t){e.more=!1}}})],1)},nt=[],st=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"island",style:{width:"20%",height:"40%"}},[n("div",{staticClass:"header"},[n("h1",{staticClass:"title",on:{click:function(t){return e.$router.push("#"+e.name)}}},[e._v(" "+e._s(e.content.Title)+" ")]),n("h1",{staticClass:"more",on:{click:function(t){return t.stopPropagation(),e.$emit("more")}}},[e._v("+")])]),n("div",{staticClass:"body"},[n("vue-markdown",{attrs:{source:e.content.Body}})],1)])},ot=[],it={name:"Island",components:{},props:["name","content"],data:function(){return{}},computed:{},created:function(){},methods:{}},rt=it,at=(n("ff49"),Object(T["a"])(rt,st,ot,!1,null,"2319eefc",null)),ct=at.exports,ut=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"overlayContainer",on:{scroll:function(e){e.stopPropagation()},mousedown:function(e){e.stopPropagation()},mouseup:function(e){e.stopPropagation()}}},[n("div",{staticClass:"overlay"},[n("span",{staticClass:"close",on:{click:function(t){return t.stopPropagation(),e.$emit("less")}}},[e._v("✕")]),e._l(e.sections,(function(e){return n("Section",{key:e.id,attrs:{section:e}})}))],2)])},lt=[],dt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("div",{staticClass:"header"},[n("h3",{staticClass:"subtitle"},[e._v(" "+e._s(e.section.Subtitle)+" ")]),n("h1",{staticClass:"title"},[e._v(" "+e._s(e.section.Title)+" ")])]),n("div",{staticClass:"body"},[n("vue-markdown",{attrs:{source:e.section.Body}})],1)])},mt=[],ft={name:"Section",props:["section"],data:function(){return{}},created:function(){}},gt=ft,ht=(n("c91c"),Object(T["a"])(gt,dt,mt,!1,null,"8202132c",null)),pt=ht.exports,vt={name:"Overlay",components:{Section:pt},props:["content"],data:function(){return{sections:[]}},created:function(){var e=this;this.content.sections||this.$http.get("".concat(this.$apiURL,"/about")).then((function(t){e.sections=t.data.Sections})).catch((function(e){console.log(e)}))}},wt=vt,bt=(n("711e"),Object(T["a"])(wt,ut,lt,!1,null,"547dc118",null)),yt=bt.exports,$t={name:"Territory",components:{Island:ct,Overlay:yt},props:["name","borders"],data:function(){return{content:{},more:!1}},computed:{},created:function(){var e=this;this.$http.get("".concat(this.$apiURL,"/").concat(this.name)).then((function(t){e.content=t.data})).catch((function(e){console.log(e)}))},methods:{toNearestX:function(e,t){return Math.floor(100*e/t)*t}}},_t=$t,Ot=(n("8ad3"),Object(T["a"])(_t,tt,nt,!1,null,"da1abb56",null)),Mt=Ot.exports,Ct=[],xt={},kt=[],St={},Tt={name:"Mainland",components:{Grid:J,Minimap:pe,Options:je,Userslist:Ye,Cursorr:F,Message:et,Territory:Mt},props:{wantsToView:Object},data:function(){return{doNotSave:!1,me:Object,editing:!1,scrolling:!1,dragging:!1,miniDragging:!1,hovered:!1}},computed:Object(b["a"])(Object(b["a"])({},Object(p["c"])(["version","registered","visited","users","messages","islands","scale","windowWidth","windowHeight","windowLeft","windowTop"])),Object(p["b"])(["islandByName","messagesByUser","userByName","userColors","userNames","connectedUsers","notDeletedUsers","notDeletedMessages","centerOf","positionOf","pixelsFrom"])),watch:{wantsToView:function(e){this.route(e.type,e.name)}},created:function(){console.log("Version: ".concat(localStorage.version)),localStorage.version!=this.version&&(console.log("this version is outdated, clearing your storage."),localStorage.clear(),localStorage.version=this.version),localStorage.me?(this.$store.commit("register"),this.me=JSON.parse(localStorage.me),this.me.deleted&&this.$store.commit("block")):localStorage.uid?(this.$store.commit("visit"),this.me.uid=localStorage.uid,this.me.color=localStorage.color):(this.me={uid:Object(y["a"])(),connected:!1,name:"newUser-"+Object(y["a"])(),color:this.randomColor(),x:0,y:0,typing:null},localStorage.uid=this.me.uid,localStorage.color=this.me.color),this.$store.commit("setUser",Object(b["a"])({},this.me)),this.$store.commit("setUID",this.me.uid),localStorage.users&&this.$store.commit("setUsers",JSON.parse(localStorage.users)),localStorage.messages&&this.$store.commit("setMessages",JSON.parse(localStorage.messages))},mounted:function(){var e=this;this.me.deleted||(window.addEventListener("resize",(function(){e.$store.commit("resize")})),this.setViewerPosition(),this.wantsToView?this.route(this.wantsToView.type,this.wantsToView.name):setTimeout((function(){e.scrollTo(e.pixelsFrom(e.islands[0].borders),"smooth")}),50),this.track())},sockets:{connect:function(){this.me.deleted||(this.me.connected=!0,this.$store.commit("setUser",Object(b["a"])({},this.me)),this.$socket.emit("user",this.me))},user:function(e){var t=JSON.parse(e);t.uid!==this.me.uid?this.$store.commit("setUser",t):!0===t.deleted&&(this.me.deleted=!0,this.$store.commit("setUser",Object(b["a"])({},this.me)),localStorage.me=JSON.stringify(this.me),window.location.reload(!0)),this.$socket.emit("users",this.users),this.$socket.emit("messages",this.messages)},users:function(e){var t=JSON.parse(e);Ct.push(t),console.log("Syncing ".concat(Ct.length," user DBs.")),this.userDBsync()},message:function(e){var t=JSON.parse(e);this.$store.commit("setMessage",t),this.$socket.emit("messages",this.messages),t.announcement&&t.author!==this.me.uid&&this.scrollTo(this.positionOf(t),"smooth")},messages:function(e){var t=JSON.parse(e);kt.push(t),console.log("Syncing ".concat(kt.length," message DBs.")),this.messageDBsync()},appearance:function(e){var t=JSON.parse(e);t.uid!==this.me.uid&&(this.$store.commit("setUser",t),localStorage.users=JSON.stringify(this.users))},clearDBs:function(){this.users={},localStorage.users=JSON.stringify(this.users),this.messages={},localStorage.messages=JSON.stringify(this.messages),window.location.reload(!0)},disconnect:function(){if(this.me.connected=!1,this.$store.commit("setUser",Object(b["a"])({},this.me)),!this.doNotSave)for(var e in localStorage.me=JSON.stringify(this.me),this.users)if(e!==this.me.uid){var t=Object(b["a"])({},this.users[e]);t.connected=!1,this.$store.commit("setUser",t)}localStorage.users=JSON.stringify(this.users),localStorage.messages=JSON.stringify(this.messages)}},methods:{isMe:function(e){return e.uid===this.me.uid},saveMe:function(e){this.me.name=e.name,this.me.color=e.color,this.$socket.emit("user",this.me),this.$store.commit("register"),this.editing=!1,localStorage.me=JSON.stringify(this.me)},deleteMe:function(){this.deleteUser(this.me),this.doNotSave=!0,localStorage.removeItem("me"),localStorage.removeItem("uid"),localStorage.removeItem("color"),window.location.reload(!0)},deleteUser:function(e){var t=this;this.messagesByUser(e).forEach((function(e){t.deleteMessage(t.messages[e.uid])})),this.$store.commit("deleteUser",e),this.$socket.emit("user",e)},deleteMessage:function(e){this.$store.commit("deleteMessage",e),this.$socket.emit("message",e)},censorMessage:function(e){this.$store.commit("censorMessage",e),this.$socket.emit("message",e)},deleteEverything:function(){this.$socket.emit("clearDBs")},updatePosition:function(e){var t=(this.windowLeft+e.x)/(this.windowWidth*this.scale),n=(this.windowTop+e.y)/(this.windowHeight*this.scale);this.me.x=t,this.me.y=n,this.me.connected=!0,this.$store.commit("setUser",Object(b["a"])({},this.me)),this.$socket.emit("appearance",this.me)},updateTyping:function(e){this.me.typing=e,this.$store.commit("setUser",Object(b["a"])({},this.me)),this.$socket.emit("appearance",this.me)},updateColor:function(e){this.me.color=e.color,this.$store.commit("setUser",Object(b["a"])({},this.me)),this.$socket.emit("appearance",this.me)},updateAppearance:function(e){this.me.name=e.name,this.me.color=e.color,this.$store.commit("setUser",Object(b["a"])({},this.me)),this.$socket.emit("appearance",this.me),this.editing=!1,localStorage.me=JSON.stringify(this.me)},sendMessage:function(e){e.content&&" "!=e.content&&this.$socket.emit("message",e)},constructMessage:function(e){var t=(new Date).getTime(),n={uid:this.me.uid+t,author:this.me.uid,content:e,time:t,color:this.me.color,x:this.me.x,y:this.me.y,deleted:!1,censored:!1,announcement:!1};return n},userDBsync:function(){for(var e in Ct.sort((function(e,t){return Object.keys(t).length-Object.keys(e).length})),xt=Ct[0],Ct.forEach((function(e){for(var t in e)xt[t]||(xt[t]=e[t]),e[t].deleted&&(xt[t].deleted=!0),e[t].name.startsWith("newUser-")||(xt[t].name=e[t].name)})),xt){var t=xt[e];e!==this.me.uid&&this.$store.commit("setUser",t)}localStorage.users=JSON.stringify(this.users)},messageDBsync:function(){for(var e in kt.sort((function(e,t){return Object.keys(t).length-Object.keys(e).length})),St=kt[0],kt.forEach((function(e){for(var t in e)St[t]||(St[t]=e[t]),e[t].deleted&&(St[t].deleted=!0),e[t].censored&&(St[t].censored=!0)})),St){var t=St[e];this.$store.commit("setMessage",t)}localStorage.messages=JSON.stringify(this.messages)},route:function(e,t){var n;if("user"==e){var s=this.userByName(t);s?n=this.positionOf(s):console.log("not found")}else if("territory"==e){var o=this.islandByName(t);o?n=this.pixelsFrom(o.borders):console.log("not found")}this.scrollTo(n,"smooth")},drag:function(e){this.scrollTo({x:this.windowLeft-e.movementX,y:this.windowTop-e.movementY})},centerMe:function(){var e=this;this.$store.commit("zero"),setTimeout((function(){e.scrollTo(e.positionOf({x:.5,y:.5}),"smooth")}),50)},scrollTo:function(e,t){this.$refs.userlandContainer.scroll({left:e.x,top:e.y,behavior:t||"auto"})},setViewerPosition:function(){this.$store.commit("viewerPosition",{x:this.$refs.userlandContainer.scrollLeft,y:this.$refs.userlandContainer.scrollTop})},randomColor:function(){var e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),n=Math.floor(256*Math.random()),s=1,o="rgb(".concat(e,", ").concat(t,", ").concat(n,", ").concat(s,")");return o},track:function(){var e,t,n,s=this,o=this.$refs.me[0].$refs.input;this.$refs.userlandContainer.addEventListener("keyup",(function(i){if(s.registered&&!s.editing){var r=i.which||i.keyCode;if(o!==document.activeElement&&(o.focus(),r>=48&&r<=90)){var a=String.fromCharCode(r);o.value=a}"~"==o.value?t=!0:"!"==o.value&&(n=!0);var c=s.messagesByUser(s.me),u=c[0],l=c[c.length-1],d=c[c.indexOf(e)-1],m=c[c.indexOf(e)+1];if(38==r)e=e?d||u:l,o.value=e.content,o.select();else if(40==r)e&&m&&(e=m,o.value=e.content,o.select());else if(13==r){var f=s.constructMessage(o.value);n?(f.announcement=!0,n=!1):t&&(f.navigation=!0,s.$router.push(o.value),t=!1),s.sendMessage(f),e=void 0,o.value="",o.placeholder=""}else 27==r&&(o.value="",o.blur());s.updateTyping(o.value),i.stopPropagation(),i.preventDefault()}})),this.$refs.userlandContainer.addEventListener("click",(function(){if(s.registered&&!s.editing&&!s.dragging){o.focus();var t=s.constructMessage(o.value);s.sendMessage(t),e=void 0,o.value="",o.placeholder=""}}))}}},jt=Tt,Pt=(n("1812"),Object(T["a"])(jt,v,w,!1,null,null,null)),Ut=Pt.exports,Nt=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},Dt=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"blocked"}},[n("div",{staticClass:"message"},[n("p",[e._v("You have been removed.")]),n("p",[e._v("Please reflect on your behaviour.")])])])}],Et={name:"Nomansland",components:{},props:[],data:function(){return{}},created:function(){},mounted:function(){var e=this.$el,t=window.innerHeight/14,n=window.innerWidth/10,s=this.tableCreate(t,n);e.appendChild(s)},methods:{tableCreate:function(e,t){for(var n=this,s=document.createElement("table"),o=0;o<e;o++)for(var i=s.insertRow(),r=function(e){var t=i.insertCell();t.innerHTML=" ",t.addEventListener("mouseover",(function(){n.repeatXI((function(){t.innerHTML=n.generate_random_string()}),100,10),setTimeout((function(){t.innerHTML=" "}),1050),setTimeout((function(){t.innerHTML=" "}),3e3)}))},a=0;a<t;a++)r(a);return s},generate_random_string:function(){var e=39,t=47,n=Math.floor(Math.random()*(t-e)+e),s=String.fromCharCode(n);return s},repeatXI:function(e,t,n){var s,o;return o=function(){e(),--n||clearInterval(s)},t=t<=0?1e3:t,n=parseInt(n,10)||0,s=setInterval(o,t),!0}}},Lt=Et,Bt=(n("32a0"),Object(T["a"])(Lt,Nt,Dt,!1,null,"55f17412",null)),zt=Bt.exports,Jt={name:"Home",components:{Mainland:Ut,Nomansland:zt},props:{slug:String},data:function(){return{wantsToView:null}},computed:Object(p["c"])(["blocked"]),created:function(){this.slug&&this.handleRouting(this.slug)},mounted:function(){var e=this;this.$router.afterEach((function(t){var n=t.fullPath.replace(e.$publicPath,"");e.handleRouting(n)}))},methods:{handleRouting:function(e){var t,n;e.startsWith("~")?t="user":e.startsWith("#")?t="territory":console.log("not found"),n=e.slice(1),n?console.log(n):console.log("no username provided"),this.wantsToView={type:t,name:n}}}},Ht=Jt,It=(n("59fc"),Object(T["a"])(Ht,g,h,!1,null,"455654d6",null)),Vt=It.exports,Wt={name:"App",components:{Home:Vt},data:function(){return{slug:window.location.pathname.replace(this.$publicPath,"")}},created:function(){},methods:{}},Xt=Wt,At=(n("034f"),Object(T["a"])(Xt,m,f,!1,null,null,null)),Rt=At.exports,Ft=n("8c4f");s["a"].use(Ft["a"]);var Yt=[{path:"/",name:"Home",component:Vt}],Gt=new Ft["a"]({mode:"history",routes:Yt}),Kt=Gt;n("4de4"),n("7db0"),n("d81d"),n("07ac");s["a"].use(p["a"]);var Zt=new p["a"].Store({state:{version:5,uid:null,registered:!1,visited:!1,blocked:!1,users:{},messages:{},islands:[{name:"center",borders:{x:.4,y:.4}}],scale:5,windowWidth:window.innerWidth,windowHeight:window.innerHeight,windowLeft:null,windowTop:null,grid:!0},mutations:{register:function(e){e.registered=!0},visit:function(e){e.visited=!0},block:function(e){e.blocked=!0},setUID:function(e,t){e.uid=t},setUsers:function(e,t){e.users=t},setUser:function(e,t){s["a"].set(e.users,t.uid,t)},deleteUser:function(e,t){t.deleted=!0,s["a"].set(e.users,t.uid,t)},setMessages:function(e,t){e.messages=t},setMessage:function(e,t){s["a"].set(e.messages,t.uid,t)},deleteMessage:function(e,t){t.deleted=!0,s["a"].set(e.messages,t.uid,t)},censorMessage:function(e,t){e.messages[t.uid].censored=!e.messages[t.uid].censored},zero:function(e){e.scale=5},zoomIn:function(e){e.scale+=.25},zoomOut:function(e){e.scale>1&&(e.scale-=.25)},viewerPosition:function(e,t){e.windowLeft=t.x,e.windowTop=t.y},resize:function(e){e.windowWidth=window.innerWidth,e.windowHeight=window.innerHeight},toggleGrid:function(e){e.grid=!e.grid}},getters:{me:function(e){return e.users[e.uid]},islandByName:function(e){return function(t){return e.islands.find((function(e){return e.name==t}))}},messagesByUser:function(e){return function(t){var n=[];for(var s in e.messages){var o=e.messages[s];o.author!=t.uid||o.deleted||n.push(o)}return n}},userByName:function(e,t){return function(n){var s=t.usersArray.find((function(e){return e.name==n}));if(s)return e.users[s.uid]}},userColors:function(e){var t={};for(var n in e.users){var s=e.users[n];t["--".concat(n)]=s.connected?s.color:"lightgrey"}return t},userNames:function(e,t){return t.notDeletedUsers.map((function(e){return e.name}))},connectedUsers:function(e,t){return t.notDeletedUsers.filter((function(e){return!0===e.connected}))},connectedUsersFirst:function(e,t){return t.notDeletedUsers.sort((function(e,t){return e.connected===t.connected?0:e.connected?-1:1}))},notDeletedUsers:function(e,t){return t.usersArray.filter((function(e){return!0!==e.deleted}))},notDeletedMessages:function(e,t){return t.messagesArray.filter((function(e){return!0!==e.deleted}))},usersArray:function(e){return Object.values(e.users)},messagesArray:function(e){return Object.values(e.messages)},centerOf:function(e,t){return function(e){return e=t.pixelsFrom(e),{x:e.x-e.w/2,y:e.y-e.h/2,w:e.w||0,h:e.h||0}}},positionOf:function(e,t){return function(n){return n=t.pixelsFrom(n),{x:n.x-e.windowWidth/2,y:n.y-e.windowHeight/2}}},pixelsFrom:function(e){return function(t){return{x:t.x*e.scale*e.windowWidth,y:t.y*e.scale*e.windowHeight,w:t.w||0,h:t.h||0}}}},strict:!1}),qt=Zt;s["a"].config.productionTip=!1,s["a"].prototype.$http=i.a,s["a"].prototype.$apiURL="https://api.obfuscation.karls.computer",s["a"].prototype.$publicPath="/",d.a.props.anchorAttributes.default=function(){return{target:"_blank",rel:"noopener noreferrer nofollow"}},s["a"].component("vue-markdown",d.a);var Qt=u()("https://io.karls.computer");s["a"].use(new a.a({connection:Qt,vuex:{store:qt,actionPrefix:"SOCKET_",mutationPrefix:"SOCKET_"}})),new s["a"]({router:Kt,store:qt,render:function(e){return e(Rt)}}).$mount("#app")},5898:function(e,t,n){},"59fc":function(e,t,n){"use strict";n("5898")},"5d18":function(e,t,n){},"6f36":function(e,t,n){},"711e":function(e,t,n){"use strict";n("aabc")},7138:function(e,t,n){"use strict";n("31ad")},7483:function(e,t,n){},"85ec":function(e,t,n){},"8ad3":function(e,t,n){"use strict";n("3392")},"8ceb":function(e,t,n){"use strict";n("909e")},"909e":function(e,t,n){},"919f":function(e,t,n){"use strict";n("c70f")},9383:function(e,t,n){},"9a7c":function(e,t,n){},a18c:function(e,t,n){},a433:function(e,t,n){},a6c4:function(e,t,n){"use strict";n("ef1a")},aabc:function(e,t,n){},c4ca:function(e,t,n){},c70f:function(e,t,n){},c91c:function(e,t,n){"use strict";n("a18c")},c9ef:function(e,t,n){"use strict";n("a433")},dda3:function(e,t,n){},e749:function(e,t,n){"use strict";n("7483")},ef1a:function(e,t,n){},fb59:function(e,t,n){"use strict";n("2d9b")},fd40:function(e,t,n){"use strict";n("dda3")},ff49:function(e,t,n){"use strict";n("4a60")}});
//# sourceMappingURL=app.4bb7cd5d.js.map